# Deep-learning-decodes-species-specific-codon-usage-signatures-in-Brassica-from-coding-sequences
# CDS Filtering Pipeline for Brassica Species
# 01_CDS_Data_Validation.py
This repository contains a Python script (01_CDS_Data_Validation.py) to filter coding sequences (CDS) from four Brassica species (B. juncea, B. napus, B. oleracea, B. rapa) downloaded from EnsemblPlants (release-61). The script validates FASTA-formatted CDS against strict biological criteria:

Length divisible by 3

Standard DNA bases only (A/T/C/G)

Valid start (ATG) and stop codons (TAA, TAG, TGA)

No internal stop codons

Correct translation to amino acids

Data Sources Raw CDS files were retrieved from:

B. juncea: ftp.ensemblgenomes.ebi.ac.uk/pub/plants/release-61/fasta/brassica_juncea/cds/

B. napus: ftp.ensemblgenomes.ebi.ac.uk/pub/plants/release-61/fasta/brassica_napus/cds/

B. oleracea: ftp.ensemblgenomes.ebi.ac.uk/pub/plants/release-61/fasta/brassica_oleracea/cds/

B. rapa: ftp.ensemblgenomes.ebi.ac.uk/pub/plants/release-61/fasta/brassica_rapa/cds/

Run the script:
# python 01_CDS_Data_Validation.py Input: FASTA files in input_dir (configured in script).

Output: Filtered FASTA files + statistics CSV (filtering_stats.csv).

Dependencies Python 3.x

Biopython (pip install biopython)

Output Filtered sequences: Valid CDS per species (.fasta).

Statistics: Detailed filtering metrics (pass/fail counts per criterion). Codon Frequency Analysis

# 02_CDS_Codon_Freq_CSV.py
# The script 02_CDS_Codon_Freq_CSV.py computes codon usage frequencies from filtered CDS sequences (generated by CDS_Data_Validation.py) and outputs a combined CSV file for downstream analysis.
Workflow Input: Filtered FASTA files (from Final_Filtered directory).

Processing:

Counts occurrences of all 64 codons per sequence.

Labels species numerically (sorted by sequence count, descending).

Output: A CSV file (combined_codon_frequencies_labeled.csv) with columns:

Species: Original species name (e.g., Brassica_napus.AST_PRJEB5043_v1.cds.all_filtered).

Label: Numeric ID (1 = highest sequence count).

Sequence_ID: FASTA record identifier.

Columns for all 64 codons (e.g., AAA, AAC, ..., TTT) with raw counts.

Example Output (First 3 Rows) Species Label Sequence_ID AAA AAC ... TTT Brassica_napus.AST_PRJEB5043_v1.cds... 1 CDY69013 6 6 ... 4 Brassica_napus.AST_PRJEB5043_v1.cds... 1 CDY71688 10 8 ... 6 Brassica_napus.AST_PRJEB5043_v1.cds... 1 CDY71689 6 1 ... 3 (Full CSV includes all 64 codons and all sequences.)

Usage
python 02_CDS_Codon_Freq_CSV.py Input Directory: Configure input_dir in the script (default: Final_Filtered).

Output: CSV saved to input_dir/combined_codon_frequencies_labeled.csv.

Dependencies Python 3.x

Biopython (pip install biopython)

Pandas (pip install pandas)

Notes Reproducibility: The script automatically sorts species by sequence count (descending) and assigns labels.

Integration: Use this CSV as input for statistical analyses or visualizations (e.g., PCA, t-SNE and UMAP).
# 03_PCA_CUB_plot.py
This script performs Principal Component Analysis (PCA) on codon frequency data. It creates a scatter plot where each point represents a gene sequence, colored by species. The plot displays the first two principal components with their explained variance percentages, helping identify major patterns in codon usage variation across species.

# 04_t_SNE.py
This script applies t-Distributed Stochastic Neighbor Embedding (t-SNE) for non-linear dimensionality reduction. It uses Barnes-Hut approximation for efficient computation and creates hexbin density plots to visualize gene distribution patterns. The output is saved as both PDF and PNG files with publication-ready formatting.

# 05_Umap_plot.py
This script implements Uniform Manifold Approximation and Projection (UMAP) for visualizing high-dimensional codon usage data. With optimized parameters for biological data, it generates hexbin density plots that preserve both local and global data structure, saved as vector graphics suitable for publications.
# Installation
bash
pip install pandas scikit-learn matplotlib seaborn umap-learn
# Data Format
Note: The same csv files data will be used to prouduce PCA, t-SNE and UMAP plts
# 06_dropout.py
# Dropout Neural Network for Species Classification

This script implements a Dropout-regularized Deep Neural Network (DNN) for multi-species classification using codon usage data. It performs 10-fold cross-validation to ensure robust model evaluation.

Key Features:

10-fold cross-validation with stratified sampling

Dropout regularization (0.3 rate) to prevent overfitting

Early stopping with patience of 5 epochs

Comprehensive metrics: accuracy, precision, recall, F1-score, and Matthews Correlation Coefficient

Saves best model and all fold models

Model Architecture:

Input layer → Dense(128, ReLU) → Dropout(0.3)

Dense(64, ReLU) → Dropout(0.3)

Dense(32, ReLU) → Dropout(0.3)

Output layer: Softmax for multi-class classification

Outputs:

Saved models for each fold and best overall model

Average confusion matrix plot

Training/validation accuracy curves

CSV file with average metrics (DO_Results.csv)

NumPy files with training histories and matrices

# Dependencies:

python
numpy, pandas, matplotlib, seaborn, scikit-learn, tensorflow


